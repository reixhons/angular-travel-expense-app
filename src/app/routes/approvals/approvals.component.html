<div class="top-trips">
    <div class="container fade-in">
        <h1>Approval Page</h1>
        <h4>Check all the pending trips and choose if you want to cancel or approve them</h4>
        <div class="grid-header">
            <div class="left">
                <div class="label">Pending</div>
                <div class="count">8</div>
            </div>
        </div>
    </div>

    @for (trip of pendingTrips; track trip.id) {
    <div class="container-2">

        <div class="approval-container box-style">
            <div class="top">
                <div class="left">
                    <div class="icon icon-holder">
                        <img src="icons/flight.svg" alt="flight">
                    </div>
                    <div class="flex items-center">
                        <div class="label">{{ userNames[trip.userId] || 'Unknown User' }} &nbsp;&nbsp;</div>
                        <div class="value"> - &nbsp; {{ trip.name }}</div>
                    </div>

                </div>
                <div class="right flex items-center gap-2">
                    <button class="colored-status status-cancelled" (click)="cancelTrip(trip.id)">Decline</button>
                    <button class="colored-status status-approved" (click)="approveTrip(trip.id)">Approve</button>
                </div>
            </div>
            <div class="divider"></div>
            <div class="trip-info">
                <div class="info">
                    <div class="icon icon-holder-easy">
                        <img src="icons/clock.svg" alt="calendar">
                    </div>
                    <div class="right">
                        <div class="label">Duration</div>
                        <div class="value"> Days</div>
                    </div>
                </div>
                <div class="info">
                    <div class="icon icon-holder-easy">
                        <img src="icons/calendar-dots.svg" alt="calendar">
                    </div>
                    <div class="right">
                        <div class="label">Date Range</div>
                        <div class="value">{{ trip.startDate | date }} - {{ trip.endDate | date }}</div>
                    </div>
                </div>
                <div class="info">
                    <div class="icon icon-holder-easy">
                        <img src="icons/rows-duotone.svg" alt="calendar">
                    </div>
                    <div class="right">
                        <div class="label">Expense Count</div>
                        <div class="value">10 Items</div>
                    </div>
                </div>
                <div class="info">
                    <div class="icon icon-holder-easy">
                        <img src="icons/currency.svg" alt="calendar">
                    </div>
                    <div class="right">
                        <div class="label">Total Cost</div>
                        <div class="green-style value">$1000</div>
                    </div>
                </div>
            </div>
            <div class="divider"></div>
            <div>
                <div class="container-below gap-4   ">

                    <div class="left">
                        <div class="up flex items-center gap-4 pl-6">
                            <div class="icon icon-holder">
                                <img src="icons/rows-duotone.svg" alt="flight">
                            </div>
                            <div class="label">Expenses</div>
                        </div>

                        <div class="expenses flex flex-col gap-4">
                            @for (expense of tripExpenses[trip.id]; track expense.id) {

                            <div class="expense flex items-center justify-between gap-4 box-style px-6 py-4">
                                <div class="left flex items-center gap-4">
                                    <div class="icon icon-holder">
                                        <img [src]="'icons/' + (
                                            expense.type === 'FLIGHT' ? 'flight' :
                                            expense.type === 'HOTEL' ? 'hotel' :
                                            expense.type === 'CAR_RENTAL' ? 'car' :
                                            'taxi') + '.svg'" alt="expense-icon">
                                    </div>
                                    <div class="label">{{ expense.type }}</div>
                                    <div class="green-style value"> $ {{ expense.totalPrice }}</div>
                                </div>
                                <div class="right">
                                    <button class="white-style" (click)="viewExpense(expense)">
                                        View
                                    </button>
                                </div>
                            </div>
                            }
                        </div>
                    </div>
                    <div class="right">
                        <div class="note-container box-style">
                            <div class="top flex items-center gap-4 justify-start">
                                <div class="icon icon-holder">
                                    <img src="icons/flight.svg" alt="flight">
                                </div>
                                <div class="label">
                                    Approver Note
                                </div>
                            </div>
                            <div class="divider"></div>
                            <div class="bottom">
                                <mat-form-field class="w-full">
                                    <textarea matInput rows="4"></textarea>
                                </mat-form-field>
                                >
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    }

    @if (pendingTrips.length === 0) {
    <div class="bg-white rounded-2xl shadow-sm p-12 text-center backdrop-blur-lg bg-opacity-90">
        <div class="flex flex-col items-center gap-4">
            <mat-icon class="!w-16 !h-16 !text-6xl text-gray-400">task_alt</mat-icon>
            <h3 class="text-xl font-medium text-gray-900">No Pending Approvals</h3>
            <p class="text-gray-600">All travel requests have been processed</p>
        </div>
    </div>
    }
</div>